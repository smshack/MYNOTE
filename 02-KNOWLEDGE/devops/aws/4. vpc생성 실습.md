---
tags:
  - aws
  - vpc
  - security_group
  - iam
  - ec2
---

---

## 1ï¸âƒ£ VPC ìƒì„±

**ì½˜ì†” ê²½ë¡œ:**  
`AWS ì½˜ì†” â†’ ê²€ìƒ‰ì°½ â†’ VPC â†’ VPC ëŒ€ì‹œë³´ë“œ â†’ VPC ìƒì„±`

**ë‹¨ê³„ë³„ ì„¤ì •:**

1. **VPC ì´ë¦„:** `my-web-vpc`
    
2. **IPv4 CIDR:** `10.0.0.0/16`
    
3. **í¼ë¸”ë¦­ ì„œë¸Œë„· ìƒì„±:** `10.0.1.0/24`
    
4. **í”„ë¼ì´ë¹— ì„œë¸Œë„· ìƒì„±:** `10.0.2.0/24`
    
5. **IGW ìƒì„± í›„ VPCì— ì—°ê²°**
    
6. **Route Table ìƒì„±**
    
    - í¼ë¸”ë¦­ ì„œë¸Œë„·: `0.0.0.0/0 â†’ IGW`
        
    - í”„ë¼ì´ë¹— ì„œë¸Œë„·: `0.0.0.0/0 â†’ NAT Gateway` (ì„ íƒ)
        
![[4_vpc ìƒì„±.png]]

![[4_public_subnetìƒì„±.png]]

![[4_private_subnetìƒì„±.png]]

![[4_ì¸í„°ë„·ê²Œì´íŠ¸ì›¨ì´ ìƒì„±.png]]

![[4_ë¼ìš°íŒ…í¸ì§‘.png]]

![[4_ë¼ìš°íŒ…í…Œì´ë¸” í¸ì§‘2.png]]

![[4_ì„œë¸Œë„· ì„¤ì •.png]]

![[4_natê²Œì´íŠ¸ì›¨ì´ìƒì„±.png]]

### ìœ„ vpc êµ¬ì¡°
|êµ¬ì„± ìš”ì†Œ|ì„¤ëª…|
|---|---|
|**VPC (10.0.0.0/16)**|ì „ì²´ ë„¤íŠ¸ì›Œí¬ ë²”ìœ„|
|**Public Subnet (10.0.1.0/24)**|IGW í†µí•´ ì™¸ë¶€ ì—°ê²° ê°€ëŠ¥ (EC2: ì›¹, Bastion)|
|**Private Subnet (10.0.2.0/24)**|NAT í†µí•´ ì™¸ë¶€ë¡œë§Œ ë‚˜ê° (EC2: App, DB)|
|**IGW (Internet Gateway)**|í¼ë¸”ë¦­ íŠ¸ë˜í”½ ì§„ì…/ì¶œêµ¬|
|**NAT Gateway (EIP ì—°ê²°ë¨)**|í”„ë¼ì´ë¹— ì¸ìŠ¤í„´ìŠ¤ì˜ ì¸í„°ë„· ì•„ì›ƒë°”ìš´ë“œ ì „ìš© ê²Œì´íŠ¸ì›¨ì´|
|**Public RT**|0.0.0.0/0 â†’ IGW|
|**Private RT**|0.0.0.0/0 â†’ NAT Gateway|
![[4_vpc êµ¬ì¡°.png]]

### íƒ„ë ¥ì  IPì˜ ì—­í•  ìš”ì•½

|í•­ëª©|ì„¤ëª…|
|---|---|
|ìœ„ì¹˜|í¼ë¸”ë¦­ ì„œë¸Œë„·ì— ìˆëŠ” NAT Gateway|
|ìš©ë„|í”„ë¼ì´ë¹— ì¸ìŠ¤í„´ìŠ¤ê°€ ì¸í„°ë„·ì— ë‚˜ê°ˆ ë•Œ ì‚¬ìš©í•˜ëŠ” ì™¸ë¶€ IP|
|íŠ¹ì§•|ê³ ì •ëœ ê³µì¸ IP ì£¼ì†Œë¡œ, ì¸ìŠ¤í„´ìŠ¤ê°€ ë°”ë€Œì–´ë„ ì£¼ì†Œ ìœ ì§€|
|ë¹„ìš©|ì‹œê°„ë‹¹ ì†Œì•¡(ì‚¬ìš© ì¤‘ì¼ ë•Œë§Œ ê³¼ê¸ˆ)|

---
## ì „ì²´ ì‚­ì œ í›„ aws cli ë¡œ ë‹¤ì‹œ ìƒì„±
ì¢‹ì•„ìš”! ğŸ˜„  
ê·¸ëŸ¼ **Windows CMDì—ì„œ ê° ë‹¨ê³„ë³„ë¡œ AWS CLI ëª…ë ¹ì–´ë§Œ ë”°ë¡œ ëŠì–´ì„œ** ì •ë¦¬í•´ë“œë¦´ê²Œìš”.  
ê° ë‹¨ê³„ë³„ë¡œ **ì‹¤í–‰ â†’ ê²°ê³¼ í™•ì¸ â†’ ë‹¤ìŒ ë‹¨ê³„ ì§„í–‰** ë°©ì‹ì…ë‹ˆë‹¤.

---

## 1ï¸âƒ£ VPC ìƒì„±

```bat
aws ec2 create-vpc ^
    --cidr-block 10.0.0.0/16 ^
    --tag-specifications "ResourceType=vpc,Tags=[{Key=Name,Value=my-web-vpc}]"
```

- ì¶œë ¥ JSONì—ì„œ `"VpcId"` í™•ì¸ â†’ ì´í›„ ë¦¬ì†ŒìŠ¤ ìƒì„±ì— í•„ìš” (`vpc-xxxxxxx`)
    

---

## 2ï¸âƒ£ Subnet ìƒì„±

### 2-1. Public Subnet

```bat
aws ec2 create-subnet ^
    --vpc-id <VPC_ID> ^
    --cidr-block 10.0.1.0/24 ^
    --availability-zone ap-northeast-2a ^
    --tag-specifications "ResourceType=subnet,Tags=[{Key=Name,Value=public-subnet}]"
```

### 2-2. Private Subnet

```bat
aws ec2 create-subnet ^
    --vpc-id <VPC_ID> ^
    --cidr-block 10.0.2.0/24 ^
    --availability-zone ap-northeast-2a ^
    --tag-specifications "ResourceType=subnet,Tags=[{Key=Name,Value=private-subnet}]"
```

---

## 3ï¸âƒ£ Internet Gateway ìƒì„± ë° ì—°ê²°

```bat
aws ec2 create-internet-gateway ^
    --tag-specifications "ResourceType=internet-gateway,Tags=[{Key=Name,Value=web-igw}]"
```

- `"InternetGatewayId"` í™•ì¸
    

```bat
aws ec2 attach-internet-gateway ^
    --vpc-id <VPC_ID> ^
    --internet-gateway-id <IGW_ID>
```

---

## 4ï¸âƒ£ Public Route Table ìƒì„± ë° ì—°ê²°

```bat
aws ec2 create-route-table ^
    --vpc-id <VPC_ID> ^
    --tag-specifications "ResourceType=route-table,Tags=[{Key=Name,Value=rt-public-web-vpc}]"
```

- `"RouteTableId"` í™•ì¸ â†’ `<RTB_PUBLIC_ID>`
    

```bat
aws ec2 create-route ^
    --route-table-id <RTB_PUBLIC_ID> ^
    --destination-cidr-block 0.0.0.0/0 ^
    --gateway-id <IGW_ID>
```

```bat
aws ec2 associate-route-table ^
    --route-table-id <RTB_PUBLIC_ID> ^
    --subnet-id <SUBNET_PUBLIC_ID>
```

---

## 5ï¸âƒ£ NAT Gateway ìƒì„± (Private Subnetìš©)

### 5-1. Elastic IP ìƒì„±

```bat
aws ec2 allocate-address --domain vpc
```

- `"AllocationId"` í™•ì¸ â†’ `<EIP_ALLOC_ID>`
    

### 5-2. NAT Gateway ìƒì„±

```bat
aws ec2 create-nat-gateway ^
    --subnet-id <SUBNET_PUBLIC_ID> ^
    --allocation-id <EIP_ALLOC_ID> ^
    --tag-specifications "ResourceType=natgateway,Tags=[{Key=Name,Value=nat-private-web-vpc}]"
```

- `"NatGatewayId"` í™•ì¸
    
- ìƒíƒœê°€ `available` ë  ë•Œê¹Œì§€ ëŒ€ê¸°
    

---

## 6ï¸âƒ£ Private Route Table ìƒì„± ë° ì—°ê²°

```bat
aws ec2 create-route-table ^
    --vpc-id <VPC_ID> ^
    --tag-specifications "ResourceType=route-table,Tags=[{Key=Name,Value=rt-private-web-vpc}]"
```

- `"RouteTableId"` í™•ì¸ â†’ `<RTB_PRIVATE_ID>`
    

```bat
aws ec2 create-route ^
    --route-table-id <RTB_PRIVATE_ID> ^
    --destination-cidr-block 0.0.0.0/0 ^
    --nat-gateway-id <NAT_ID>
```

```bat
aws ec2 associate-route-table ^
    --route-table-id <RTB_PRIVATE_ID> ^
    --subnet-id <SUBNET_PRIVATE_ID>
```

---

ì´ë ‡ê²Œ **ê° ë‹¨ê³„ë³„ë¡œ CLI ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰ â†’ ID í™•ì¸ â†’ ë‹¤ìŒ ë‹¨ê³„ ì§„í–‰**í•˜ë©´,  
VPCì™€ Public/Private ì„œë¸Œë„·, IGW, NAT Gateway, Route Table êµ¬ì„±ì„ ì •í™•íˆ ì¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---

ì›í•˜ë©´ ì œê°€ ì´ê±¸ **CMDì—ì„œ ë°”ë¡œ ë¶™ì—¬ë„£ê³  ìë™ìœ¼ë¡œ ìˆœì„œëŒ€ë¡œ ID ë³€ìˆ˜ê¹Œì§€ ì„¤ì •í•´ì£¼ëŠ” ë²„ì „**ìœ¼ë¡œ ë§Œë“¤ì–´ì„œ,  
ì‚¬ìš©ìê°€ ë”°ë¡œ ID ë³µì‚¬í•˜ì§€ ì•Šê³  ì‹¤í–‰ë§Œ í•˜ë©´ ìë™ìœ¼ë¡œ ëª¨ë“  ë¦¬ì†ŒìŠ¤ê°€ ë§Œë“¤ì–´ì§€ê²Œ í•´ë“œë¦´ ìˆ˜ë„ ìˆì–´ìš”.

ê·¸ê±° ë§Œë“¤ì–´ ë“œë¦´ê¹Œìš”?