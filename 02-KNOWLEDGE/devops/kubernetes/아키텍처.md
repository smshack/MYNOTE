# 1ï¸âƒ£ Kubernetes ì „ì²´ ì•„í‚¤í…ì²˜

```mermaid
flowchart LR
    subgraph Master[Control Plane]
        APIServer[kube-apiserver]
        Controller[kube-controller-manager]
        Scheduler[kube-scheduler]
        ETCD[(etcd)]
    end

    subgraph Node1[Worker Node #1]
        Kubelet1[kubelet]
        Proxy1[kube-proxy]
        PodA[Pod A]
        PodB[Pod B]
    end

    subgraph Node2[Worker Node #2]
        Kubelet2[kubelet]
        Proxy2[kube-proxy]
        PodC[Pod C]
    end

    APIServer <-->|Read/Write| ETCD
    APIServer -->|Pod ìƒì„± ëª…ë ¹| Scheduler
    Scheduler -->|Node ì„ íƒ| Kubelet1
    Scheduler --> Kubelet2
    Kubelet1 --> PodA
    Kubelet1 --> PodB
    Kubelet2 --> PodC

    Proxy1 <-->|Cluster Networking| Proxy2
```

---

# 2ï¸âƒ£ ETCD (Key-Value Store)

Kubernetesì˜ ëª¨ë“  ìƒíƒœê°€ ì €ì¥ë˜ëŠ” ì¤‘ì•™ ì €ì¥ì†Œ.

### ì €ì¥ë˜ëŠ” ì •ë³´ ì˜ˆ:

- Pod / Deployment / ReplicaSet
    
- Node ì •ë³´
    
- ConfigMap, Secret
    
- RBAC ì •ë³´
    

```mermaid
flowchart TD
    ETCD[(ETCD)]
    ETCD --> Keys1[/PODS/]
    ETCD --> Keys2[/NODES/]
    ETCD --> Keys3[/SECRETS/]
    ETCD --> Keys4[/CONFIGMAPS/]
    ETCD --> Keys5[/RBAC/]
```

---

# 3ï¸âƒ£ kube-apiserver íë¦„

```mermaid
sequenceDiagram
    participant User
    participant API as kube-apiserver
    participant ETCD
    participant Scheduler
    participant Kubelet

    User->>API: kubectl apply -f pod.yaml
    API->>API: ì¸ì¦/ì¸ê°€/ê²€ì¦
    API->>ETCD: Pod ìŠ¤í™ ì €ì¥
    API->>Scheduler: ìŠ¤ì¼€ì¤„ë§ ìš”ì²­
    Scheduler->>Kubelet: ì„ íƒëœ Nodeì— Pod ìƒì„± ìš”ì²­
    Kubelet->>API: Pod ìƒíƒœ ë³´ê³ 
```

---

# 4ï¸âƒ£ Controller Manager ë™ì‘ êµ¬ì¡°

```mermaid
flowchart LR
    CM[kube-controller-manager] --> NodeCtrl[Node Controller]
    CM --> ReplicationCtrl[Replication Controller]
    CM --> DeployCtrl[Deployment Controller]
    CM --> JobCtrl[Job Controller]
    CM --> PVPCtrl[PV/PVC Controller]
```

ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” â€œDesired State(ì›í•˜ëŠ” ìƒíƒœ)â€ ë¥¼ ìœ ì§€í•˜ëŠ” ì—­í• .

---

# 5ï¸âƒ£ Scheduler ë™ì‘ êµ¬ì¡°

```mermaid
flowchart TD
    Pending[Pending Pod] --> Filter[Node í•„í„°ë§]
    Filter --> Score[Node ì ìˆ˜ ë§¤ê¸°ê¸°]
    Score --> SelectNode[ìµœì  ë…¸ë“œ ì„ íƒ]
    SelectNode --> Kubelet[ì„ íƒëœ Nodeì˜ Kubeletì´ Pod ìƒì„±]
```

---

# 6ï¸âƒ£ Kubelet êµ¬ì¡°

```mermaid
flowchart TD
    APIServer[kube-apiserver] --> Kubelet
    Kubelet --> CRI[Container Runtime (containerd)]
    CRI --> Pod1[Pod ì‹¤í–‰]
    Kubelet --> Monitor[ì»¨í…Œì´ë„ˆ ìƒíƒœ ëª¨ë‹ˆí„°ë§]
    Monitor --> APIServer
```

---

# 7ï¸âƒ£ Kube-proxy / Service êµ¬ì¡°ë„

ì¿ ë²„ë„¤í‹°ìŠ¤ëŠ” Podê°€ ë°”ë€Œì–´ë„ Service IP(ClusterIP)ê°€ ê³ ì •ë˜ì–´ ì•ˆì •ì ì¸ ì„œë¹„ìŠ¤ ì—°ê²°ì„ ë³´ì¥í•œë‹¤.

---

## ğŸ”¹ Service íƒ€ì…ë³„ êµ¬ì¡°

### (1) ClusterIP

```mermaid
flowchart LR
    Client --> SVC["Service (ClusterIP)"]
    SVC --> Pod1["Pod #1"]
    SVC --> Pod2["Pod #2"]
```

---

### (2) NodePort

```mermaid
flowchart LR
    User -->|NodePort 30080| Node1
    Node1 --> SVC[Service]
    SVC --> PodA
    SVC --> PodB
```

---

### (3) LoadBalancer

```mermaid
flowchart TD
    LB[Cloud LoadBalancer] --> Node1
    LB --> Node2

    Node1 --> SVC[Service]
    Node2 --> SVC

    SVC --> Pod1
    SVC --> Pod2
```

---

### (4) ExternalName

```mermaid
flowchart TD
    SVC["Service (ExternalName)"] --> DNS[CNAME â†’ ì™¸ë¶€ë„ë©”ì¸]
```

---

# 8ï¸âƒ£ Service â†’ Pod íŠ¸ë˜í”½ íë¦„ (kube-proxy iptables/ipvs)

```mermaid
flowchart LR
    Client --> ServiceIP[ClusterIP]
    ServiceIP --> Proxy[kube-proxy]
    Proxy --> Pod1
    Proxy --> Pod2
```

---

# 9ï¸âƒ£ ì „ì²´ ë„¤íŠ¸ì›Œí¬ êµ¬ì¡° ì¢…í•©

```mermaid
flowchart LR
    Client --> Ingress --> Service --> kube-proxy --> PodA
    Service --> kube-proxy --> PodB

    subgraph Node1
        PodA
        PodB
        kube-proxy
    end
```

---

# ğŸ”Ÿ ìš”ì•½

|êµ¬ì„± ìš”ì†Œ|ì—­í• |
|---|---|
|**etcd**|ëª¨ë“  í´ëŸ¬ìŠ¤í„° ìƒíƒœ ì €ì¥|
|**kube-apiserver**|ì¤‘ì•™ API, ëª¨ë“  ìš”ì²­ ê´€ë¬¸|
|**scheduler**|Pod ì‹¤í–‰í•  Node ì„ íƒ|
|**controller-manager**|Desired State ìœ ì§€|
|**kubelet**|Nodeì—ì„œ Pod ì‹¤í–‰ ê´€ë¦¬|
|**kube-proxy**|ì„œë¹„ìŠ¤ ë„¤íŠ¸ì›Œí¬ êµ¬ì„±|
|**Service**|Pod ê·¸ë£¹ì„ ì•ˆì •ì ìœ¼ë¡œ ë…¸ì¶œ|
|**ClusterIP**|ë‚´ë¶€ í†µì‹ ìš© ê¸°ë³¸ ì„œë¹„ìŠ¤|
|**NodePort**|ì™¸ë¶€ì—ì„œ Node IPë¡œ ì ‘ê·¼|
|**LoadBalancer**|í´ë¼ìš°ë“œ L4/L7 ì‚¬ìš©|
|**ExternalName**|DNS CNAME ë°©ì‹|

---

